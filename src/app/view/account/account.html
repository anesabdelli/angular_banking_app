<div class="account-root">
  <h2>Mon espace compte</h2>

  <!-- Affichage de l'utilisateur -->
  <div>
    {{ user ? 'Bienvenue, ' + user.name : '' }}
  </div>

  <!-- Messages d'erreur et loading -->
  <div class="error">{{ error() || '' }}</div>
  <div class="loading">{{ loading() ? 'Chargement...' : '' }}</div>

  <!-- Contenu principal -->
  <div>
    <!-- Vérifie que ce n'est pas loading et qu'on a des comptes -->
    <div *ngIf="!loading() && accounts().length > 0; else noAccounts">
      
      <!-- Dropdown pour choisir le compte -->
      <div>
        <label for="accountSelect">Choisir un compte:</label>
        <select id="accountSelect" (change)="onAccountChange($event)">
          <option 
            *ngFor="let acc of accounts()" 
            [value]="acc.accountId"
            [selected]="account() && account()!.accountId === acc.accountId">
            {{ acc.label || acc.accountId }} — {{ acc.balance | currency:'EUR' }}
          </option>
        </select>
      </div>

      <!-- Infos du compte sélectionné -->
      <section class="account-details">
        <h3>{{ account() ? (account()!.label || 'Compte') + ' (' + account()!.accountId + ')' : '' }}</h3>
        <p><strong>Solde:</strong> {{ account() ? (account()!.balance | currency:'EUR') : '' }}</p>
        <p><strong>Ouvert le:</strong> {{ account() ? (account()!.createdAt | date:'dd/MM/yyyy') : '' }}</p>

        <!-- Boutons d'action -->
        <div class="actions">
          <button (click)="onInfosClick()">Infos</button>
          <button (click)="onSendClick()">Envoyer</button>
          <button (click)="onOpenClick()">Ouvrir</button>
          <button (click)="onViewAllClick()">Voir tous</button>
        </div>
      </section>

    </div>
  </div>

  <!-- Message si aucun compte -->
  <ng-template #noAccounts>
    <p>Aucun compte trouvé pour cet utilisateur.</p>
    <button (click)="onOpenClick()">Ouvrir un compte</button>
  </ng-template>

</div>
